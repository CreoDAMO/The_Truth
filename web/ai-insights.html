
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI-Powered Extensions - The Truth NFT</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.ethers.io/lib/ethers-5.7.2.umd.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
</head>
<body class="bg-black text-white min-h-screen">
    <div id="ai-root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        function AIInterface() {
            const [activeTab, setActiveTab] = useState('analyzer');
            const [account, setAccount] = useState(null);
            const [loading, setLoading] = useState(false);
            const [analysisResult, setAnalysisResult] = useState(null);
            const [insights, setInsights] = useState(null);

            const connectWallet = async () => {
                if (typeof window.ethereum !== 'undefined') {
                    try {
                        const accounts = await window.ethereum.request({ 
                            method: 'eth_requestAccounts' 
                        });
                        setAccount(accounts[0]);
                        loadPersonalizedInsights(accounts[0]);
                    } catch (error) {
                        console.error('Failed to connect wallet:', error);
                    }
                }
            };

            const loadPersonalizedInsights = async (address) => {
                try {
                    const response = await fetch(`/api/ai/generate-insights/${address}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({})
                    });
                    const data = await response.json();
                    setInsights(data);
                } catch (error) {
                    console.error('Failed to load insights:', error);
                }
            };

            const analyzeContent = async (content, analysisType) => {
                setLoading(true);
                try {
                    const response = await fetch('/api/ai/analyze-content', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ content, analysisType })
                    });
                    const result = await response.json();
                    setAnalysisResult(result.analysis);
                } catch (error) {
                    alert('Analysis failed: ' + error.message);
                } finally {
                    setLoading(false);
                }
            };

            const generateImage = async (prompt, style, theme) => {
                setLoading(true);
                try {
                    const response = await fetch('/api/ai/generate-image', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            prompt,
                            style,
                            philosophicalTheme: theme
                        })
                    });
                    const result = await response.json();
                    alert(`Image generated! ID: ${result.generationId}`);
                } catch (error) {
                    alert('Image generation failed: ' + error.message);
                } finally {
                    setLoading(false);
                }
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-green-900 via-black to-blue-900">
                    {/* Header */}
                    <div className="border-b border-green-500/30 bg-black/50 backdrop-blur-sm">
                        <div className="container mx-auto px-6 py-4">
                            <div className="flex items-center justify-between">
                                <h1 className="text-2xl font-bold bg-gradient-to-r from-green-400 to-blue-400 bg-clip-text text-transparent">
                                    AI-Powered Truth Extensions
                                </h1>
                                <div className="flex items-center gap-4">
                                    <a href="/" className="text-green-400 hover:text-green-300">‚Üê Back to Home</a>
                                    {!account ? (
                                        <button
                                            onClick={connectWallet}
                                            className="bg-green-600 hover:bg-green-700 px-4 py-2 rounded-lg"
                                        >
                                            Connect Wallet
                                        </button>
                                    ) : (
                                        <div className="text-sm text-green-400">
                                            {account.slice(0, 6)}...{account.slice(-4)}
                                        </div>
                                    )}
                                </div>
                            </div>
                        </div>
                    </div>

                    <div className="container mx-auto px-6 py-8">
                        {/* Tab Navigation */}
                        <div className="flex space-x-1 bg-black/50 p-1 rounded-lg mb-8">
                            {[
                                { id: 'analyzer', label: 'Truth Analyzer' },
                                { id: 'insights', label: 'Personal Insights' },
                                { id: 'generator', label: 'Image Generator' },
                                { id: 'metadata', label: 'Dynamic Metadata' }
                            ].map(tab => (
                                <button
                                    key={tab.id}
                                    onClick={() => setActiveTab(tab.id)}
                                    className={`flex-1 py-3 px-4 rounded-md transition-all ${
                                        activeTab === tab.id
                                            ? 'bg-green-600 text-white'
                                            : 'text-green-300 hover:text-white hover:bg-green-600/30'
                                    }`}
                                >
                                    {tab.label}
                                </button>
                            ))}
                        </div>

                        {/* Truth Analyzer */}
                        {activeTab === 'analyzer' && (
                            <div className="bg-black/30 backdrop-blur-sm rounded-xl p-8 border border-green-500/30">
                                <h2 className="text-2xl font-bold mb-6 text-green-300">Truth Witnessing & Analysis Bot</h2>
                                <div className="grid md:grid-cols-2 gap-8">
                                    <div className="space-y-6">
                                        <div>
                                            <h3 className="text-lg font-semibold mb-4">Submit Content for Analysis</h3>
                                            <textarea
                                                id="content-input"
                                                className="w-full bg-black/50 border border-green-500/30 rounded-lg px-4 py-3 h-32"
                                                placeholder="Paste article, news, or content to analyze through The Truth philosophical lens..."
                                            />
                                        </div>
                                        
                                        <div>
                                            <h4 className="font-semibold mb-3">Analysis Type</h4>
                                            <div className="space-y-2">
                                                <label className="flex items-center gap-3">
                                                    <input type="radio" name="analysis" value="truth_validation" defaultChecked />
                                                    <span>Truth Validation Score</span>
                                                </label>
                                                <label className="flex items-center gap-3">
                                                    <input type="radio" name="analysis" value="philosophy_alignment" />
                                                    <span>Philosophy Alignment</span>
                                                </label>
                                                <label className="flex items-center gap-3">
                                                    <input type="radio" name="analysis" value="institutional_gap" />
                                                    <span>Institutional Translation Gap</span>
                                                </label>
                                            </div>
                                        </div>
                                        
                                        <button
                                            onClick={() => {
                                                const content = document.getElementById('content-input').value;
                                                const analysisType = document.querySelector('input[name="analysis"]:checked').value;
                                                analyzeContent(content, analysisType);
                                            }}
                                            disabled={loading}
                                            className="w-full bg-green-600 hover:bg-green-700 disabled:opacity-50 py-3 rounded-lg"
                                        >
                                            {loading ? 'Analyzing...' : 'Analyze Content'}
                                        </button>
                                    </div>
                                    
                                    <div className="space-y-6">
                                        {analysisResult ? (
                                            <div className="bg-green-900/30 p-6 rounded-lg border border-green-500/30">
                                                <h4 className="font-semibold mb-4">Analysis Results</h4>
                                                <div className="space-y-4">
                                                    <div>
                                                        <div className="flex justify-between items-center mb-2">
                                                            <span>Truth Score</span>
                                                            <span className="font-bold text-green-400">{analysisResult.score}%</span>
                                                        </div>
                                                        <div className="bg-black/50 rounded-full h-2">
                                                            <div 
                                                                className="bg-green-500 h-2 rounded-full" 
                                                                style={{width: `${analysisResult.score}%`}}
                                                            ></div>
                                                        </div>
                                                    </div>
                                                    
                                                    <div>
                                                        <h5 className="font-semibold mb-2">Key Insights:</h5>
                                                        <ul className="space-y-1 text-sm text-gray-300">
                                                            {analysisResult.insights?.map((insight, index) => (
                                                                <li key={index} className="flex items-start gap-2">
                                                                    <span className="text-green-400 mt-1">‚Ä¢</span>
                                                                    <span>{insight}</span>
                                                                </li>
                                                            ))}
                                                        </ul>
                                                    </div>
                                                    
                                                    {analysisResult.truthMoments && (
                                                        <div>
                                                            <h5 className="font-semibold mb-2">Truth Moments Identified:</h5>
                                                            <ul className="space-y-1 text-sm text-gray-300">
                                                                {analysisResult.truthMoments.map((moment, index) => (
                                                                    <li key={index} className="flex items-start gap-2">
                                                                        <span className="text-blue-400 mt-1">üîÆ</span>
                                                                        <span>{moment}</span>
                                                                    </li>
                                                                ))}
                                                            </ul>
                                                        </div>
                                                    )}
                                                </div>
                                            </div>
                                        ) : (
                                            <div className="bg-gray-900/30 p-6 rounded-lg border border-gray-500/30 text-center">
                                                <p className="text-gray-400">Submit content to see AI analysis results</p>
                                            </div>
                                        )}
                                        
                                        <div className="bg-blue-900/30 p-4 rounded-lg">
                                            <h5 className="font-semibold mb-2 text-blue-300">How It Works</h5>
                                            <ul className="text-sm text-gray-300 space-y-1">
                                                <li>‚Ä¢ AI analyzes content through Truth philosophy lens</li>
                                                <li>‚Ä¢ Identifies institutional translation gaps</li>
                                                <li>‚Ä¢ Scores alignment with abundance principles</li>
                                                <li>‚Ä¢ Suggests truth validation methods</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* Personal Insights */}
                        {activeTab === 'insights' && (
                            <div className="bg-black/30 backdrop-blur-sm rounded-xl p-8 border border-green-500/30">
                                <h2 className="text-2xl font-bold mb-6 text-green-300">Personalized AI Insights</h2>
                                {insights ? (
                                    <div className="space-y-6">
                                        <div className="bg-purple-900/30 p-6 rounded-lg border border-purple-500/30">
                                            <h3 className="text-lg font-semibold mb-4">Personal Message</h3>
                                            <p className="text-gray-300">{insights.personalizedMessage}</p>
                                            <div className="mt-4 flex justify-between items-center">
                                                <span>Your Truth Score:</span>
                                                <span className="text-2xl font-bold text-green-400">{insights.truthScore}%</span>
                                            </div>
                                        </div>
                                        
                                        <div className="grid md:grid-cols-2 gap-6">
                                            <div className="bg-blue-900/30 p-6 rounded-lg border border-blue-500/30">
                                                <h4 className="font-semibold mb-4">Recommended Content</h4>
                                                <ul className="space-y-2">
                                                    {insights.recommendedContent.map((content, index) => (
                                                        <li key={index} className="flex items-start gap-2">
                                                            <span className="text-blue-400 mt-1">üìö</span>
                                                            <span className="text-sm">{content}</span>
                                                        </li>
                                                    ))}
                                                </ul>
                                            </div>
                                            
                                            <div className="bg-green-900/30 p-6 rounded-lg border border-green-500/30">
                                                <h4 className="font-semibold mb-4">Next Recommendations</h4>
                                                <ul className="space-y-2">
                                                    {insights.nextRecommendations.map((rec, index) => (
                                                        <li key={index} className="flex items-start gap-2">
                                                            <span className="text-green-400 mt-1">üí°</span>
                                                            <span className="text-sm">{rec}</span>
                                                        </li>
                                                    ))}
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                ) : account ? (
                                    <div className="text-center py-12">
                                        <div className="animate-spin w-8 h-8 border-2 border-green-500 border-t-transparent rounded-full mx-auto mb-4"></div>
                                        <p className="text-gray-400">Generating personalized insights...</p>
                                    </div>
                                ) : (
                                    <div className="text-center py-12">
                                        <p className="text-gray-400 mb-4">Connect your wallet to receive personalized AI insights</p>
                                        <button
                                            onClick={connectWallet}
                                            className="bg-green-600 hover:bg-green-700 px-6 py-3 rounded-lg"
                                        >
                                            Connect Wallet
                                        </button>
                                    </div>
                                )}
                            </div>
                        )}

                        {/* Image Generator */}
                        {activeTab === 'generator' && (
                            <div className="bg-black/30 backdrop-blur-sm rounded-xl p-8 border border-green-500/30">
                                <h2 className="text-2xl font-bold mb-6 text-green-300">AI Image Generator for Community Creators</h2>
                                <div className="grid md:grid-cols-2 gap-8">
                                    <div className="space-y-6">
                                        <div>
                                            <label className="block font-semibold mb-2">Image Prompt</label>
                                            <textarea
                                                id="image-prompt"
                                                className="w-full bg-black/50 border border-green-500/30 rounded-lg px-4 py-3 h-24"
                                                placeholder="Describe the image you want to generate..."
                                                defaultValue="A philosophical landscape showing the gap between truth and perception"
                                            />
                                        </div>
                                        
                                        <div>
                                            <label className="block font-semibold mb-2">Art Style</label>
                                            <select 
                                                id="art-style"
                                                className="w-full bg-black/50 border border-green-500/30 rounded-lg px-4 py-3"
                                            >
                                                <option value="photorealistic">Photorealistic</option>
                                                <option value="abstract">Abstract</option>
                                                <option value="minimalist">Minimalist</option>
                                                <option value="surreal">Surreal</option>
                                                <option value="geometric">Geometric</option>
                                            </select>
                                        </div>
                                        
                                        <div>
                                            <label className="block font-semibold mb-2">Philosophical Theme</label>
                                            <select 
                                                id="phil-theme"
                                                className="w-full bg-black/50 border border-green-500/30 rounded-lg px-4 py-3"
                                            >
                                                <option value="abundance">Abundance vs Scarcity</option>
                                                <option value="truth">Truth vs Translation</option>
                                                <option value="paradox">Paradox Resolution</option>
                                                <option value="institutional">Institutional Gaps</option>
                                            </select>
                                        </div>
                                        
                                        <button
                                            onClick={() => {
                                                const prompt = document.getElementById('image-prompt').value;
                                                const style = document.getElementById('art-style').value;
                                                const theme = document.getElementById('phil-theme').value;
                                                generateImage(prompt, style, theme);
                                            }}
                                            disabled={loading}
                                            className="w-full bg-green-600 hover:bg-green-700 disabled:opacity-50 py-3 rounded-lg"
                                        >
                                            {loading ? 'Generating...' : 'Generate Image'}
                                        </button>
                                    </div>
                                    
                                    <div className="space-y-6">
                                        <div className="bg-gray-900/50 aspect-square rounded-lg border-2 border-dashed border-gray-600 flex items-center justify-center">
                                            <div className="text-center text-gray-400">
                                                <span className="text-4xl block mb-2">üé®</span>
                                                <p>Generated image will appear here</p>
                                            </div>
                                        </div>
                                        
                                        <div className="bg-purple-900/30 p-4 rounded-lg">
                                            <h4 className="font-semibold mb-2 text-purple-300">AI Features</h4>
                                            <ul className="text-sm text-gray-300 space-y-1">
                                                <li>‚Ä¢ Philosophy-aligned prompting</li>
                                                <li>‚Ä¢ Truth-themed visual elements</li>
                                                <li>‚Ä¢ Institutional gap visualization</li>
                                                <li>‚Ä¢ Community creator licensing</li>
                                                <li>‚Ä¢ NFT metadata integration</li>
                                            </ul>
                                        </div>
                                        
                                        <div className="bg-blue-900/30 p-4 rounded-lg">
                                            <h4 className="font-semibold mb-2 text-blue-300">Usage Rights</h4>
                                            <p className="text-sm text-gray-300">
                                                Generated images are free for Truth NFT holders to use in community content, 
                                                social media, and derivative works that align with the philosophical framework.
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* Dynamic Metadata */}
                        {activeTab === 'metadata' && (
                            <div className="bg-black/30 backdrop-blur-sm rounded-xl p-8 border border-green-500/30">
                                <h2 className="text-2xl font-bold mb-6 text-green-300">Dynamic NFT Metadata</h2>
                                <div className="grid md:grid-cols-2 gap-8">
                                    <div>
                                        <h3 className="text-lg font-semibold mb-4">How Metadata Evolves</h3>
                                        <ul className="space-y-3 text-gray-300">
                                            <li className="flex items-start gap-3">
                                                <span className="text-green-400 mt-1">üîÑ</span>
                                                <div>
                                                    <div className="font-semibold">Community Engagement</div>
                                                    <div className="text-sm">Metadata updates based on holder participation</div>
                                                </div>
                                            </li>
                                            <li className="flex items-start gap-3">
                                                <span className="text-blue-400 mt-1">üìä</span>
                                                <div>
                                                    <div className="font-semibold">Truth Score Evolution</div>
                                                    <div className="text-sm">Score changes with philosophical alignment</div>
                                                </div>
                                            </li>
                                            <li className="flex items-start gap-3">
                                                <span className="text-purple-400 mt-1">üé≠</span>
                                                <div>
                                                    <div className="font-semibold">Interaction Milestones</div>
                                                    <div className="text-sm">New traits unlock with community actions</div>
                                                </div>
                                            </li>
                                            <li className="flex items-start gap-3">
                                                <span className="text-yellow-400 mt-1">‚ö°</span>
                                                <div>
                                                    <div className="font-semibold">Evolution Stages</div>
                                                    <div className="text-sm">NFT evolves through wisdom stages</div>
                                                </div>
                                            </li>
                                        </ul>
                                    </div>
                                    
                                    <div className="space-y-6">
                                        <div className="bg-black/50 p-6 rounded-lg border border-green-500/20">
                                            <h4 className="font-semibold mb-4">Example Dynamic Metadata</h4>
                                            <div className="space-y-3 text-sm">
                                                <div className="flex justify-between">
                                                    <span>Truth Score:</span>
                                                    <span className="text-green-400 font-semibold">94.5%</span>
                                                </div>
                                                <div className="flex justify-between">
                                                    <span>Interaction Level:</span>
                                                    <span className="text-blue-400 font-semibold">Active</span>
                                                </div>
                                                <div className="flex justify-between">
                                                    <span>Philosophy Alignment:</span>
                                                    <span className="text-purple-400 font-semibold">Deep</span>
                                                </div>
                                                <div className="flex justify-between">
                                                    <span>Community Engagement:</span>
                                                    <span className="text-yellow-400 font-semibold">High</span>
                                                </div>
                                                <div className="flex justify-between">
                                                    <span>Evolution Stage:</span>
                                                    <span className="text-pink-400 font-semibold">Enlightened</span>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div className="bg-orange-900/30 p-4 rounded-lg">
                                            <h4 className="font-semibold mb-2 text-orange-300">Update Triggers</h4>
                                            <ul className="text-sm text-gray-300 space-y-1">
                                                <li>‚Ä¢ Governance participation</li>
                                                <li>‚Ä¢ Community content creation</li>
                                                <li>‚Ä¢ Philosophy discussion engagement</li>
                                                <li>‚Ä¢ Truth validation activities</li>
                                                <li>‚Ä¢ Referral program participation</li>
                                            </ul>
                                        </div>
                                        
                                        <button
                                            onClick={() => {
                                                fetch('/api/ai/update-metadata', {
                                                    method: 'POST',
                                                    headers: { 'Content-Type': 'application/json' },
                                                    body: JSON.stringify({
                                                        tokenId: 1,
                                                        interactionData: { engagementLevel: 'High', stage: 'Enlightened' }
                                                    })
                                                }).then(res => res.json()).then(data => {
                                                    alert('Metadata updated successfully!');
                                                });
                                            }}
                                            disabled={!account}
                                            className="w-full bg-green-600 hover:bg-green-700 disabled:opacity-50 py-3 rounded-lg"
                                        >
                                            Trigger Metadata Update
                                        </button>
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        ReactDOM.render(<AIInterface />, document.getElementById('ai-root'));
    </script>
</body>
</html>
