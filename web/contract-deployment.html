
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NFT Contract Deployment Dashboard - The Truth</title>
    <script src="https://cdn.ethers.io/lib/ethers-5.7.2.umd.min.js"></script>
    <script src="contract-config.js"></script>
    <script src="deploy-with-metamask.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        .glass { background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2); }
        body { background: linear-gradient(135deg, #1a1a1a, #2d2d2d); }
        .status-deployed { color: #4CAF50; }
        .status-pending { color: #ff6b6b; }
    </style>
</head>
<body class="min-h-screen text-white">
    <div class="max-w-6xl mx-auto p-8">
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold mb-4 bg-gradient-to-r from-yellow-400 to-orange-500 bg-clip-text text-transparent">
                NFT Contract Deployment Dashboard
            </h1>
            <p class="text-lg opacity-80">Deploy and manage your Truth NFT ecosystem contracts</p>
        </div>

        <!-- Deployment Overview -->
        <div class="glass rounded-xl p-6 mb-8">
            <h2 class="text-2xl font-semibold mb-4">Deployment Overview</h2>
            <div class="grid md:grid-cols-3 gap-6">
                <div class="text-center">
                    <div class="text-3xl font-bold" id="deployedCount">0</div>
                    <div class="text-sm opacity-60">Contracts Deployed</div>
                </div>
                <div class="text-center">
                    <div class="text-3xl font-bold" id="totalContracts">6</div>
                    <div class="text-sm opacity-60">Total Contracts</div>
                </div>
                <div class="text-center">
                    <div class="text-3xl font-bold" id="deploymentProgress">0%</div>
                    <div class="text-sm opacity-60">Completion</div>
                </div>
            </div>
        </div>

        <!-- Contract Status Grid -->
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
            <!-- The Truth NFT -->
            <div class="glass rounded-xl p-6" id="contract-TheTruth">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-xl font-semibold">The Truth NFT</h3>
                    <div class="status-indicator" id="status-TheTruth">‚ùå</div>
                </div>
                <div class="space-y-2 text-sm">
                    <p><strong>Supply:</strong> 77 editions</p>
                    <p><strong>Price:</strong> 0.0777 ETH (~$777)</p>
                    <p><strong>Type:</strong> ERC-721 (Unique)</p>
                    <div class="mt-4">
                        <div class="text-xs opacity-60" id="address-TheTruth">Not deployed</div>
                        <button onclick="deployContract('TheTruth')" class="mt-2 bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded text-sm">
                            Deploy Contract
                        </button>
                    </div>
                </div>
            </div>

            <!-- Bonus Gift NFT -->
            <div class="glass rounded-xl p-6" id="contract-TruthBonusGift">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-xl font-semibold">Bonus Gift</h3>
                    <div class="status-indicator" id="status-TruthBonusGift">‚ùå</div>
                </div>
                <div class="space-y-2 text-sm">
                    <p><strong>Supply:</strong> 145,000 editions</p>
                    <p><strong>Price:</strong> $145 each</p>
                    <p><strong>Type:</strong> ERC-1155 (Multiple)</p>
                    <div class="mt-4">
                        <div class="text-xs opacity-60" id="address-TruthBonusGift">Not deployed</div>
                        <button onclick="deployContract('TruthBonusGift')" class="mt-2 bg-purple-600 hover:bg-purple-700 px-4 py-2 rounded text-sm">
                            Deploy Contract
                        </button>
                    </div>
                </div>
            </div>

            <!-- Part Three Blackpaper -->
            <div class="glass rounded-xl p-6" id="contract-TruthPartThree">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-xl font-semibold">Part Three</h3>
                    <div class="status-indicator" id="status-TruthPartThree">‚ùå</div>
                </div>
                <div class="space-y-2 text-sm">
                    <p><strong>Supply:</strong> 444 editions</p>
                    <p><strong>Price:</strong> $1,777 each</p>
                    <p><strong>Type:</strong> ERC-721 (Blackpaper)</p>
                    <div class="mt-4">
                        <div class="text-xs opacity-60" id="address-TruthPartThree">Not deployed</div>
                        <button onclick="deployContract('TruthPartThree')" class="mt-2 bg-green-600 hover:bg-green-700 px-4 py-2 rounded text-sm">
                            Deploy Contract
                        </button>
                    </div>
                </div>
            </div>

            <!-- Payment Splitter -->
            <div class="glass rounded-xl p-6" id="contract-PaymentSplitter">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-xl font-semibold">Payment Splitter</h3>
                    <div class="status-indicator" id="status-PaymentSplitter">‚ùå</div>
                </div>
                <div class="space-y-2 text-sm">
                    <p><strong>Purpose:</strong> Revenue distribution</p>
                    <p><strong>Type:</strong> Financial utility</p>
                    <p><strong>Splits:</strong> Multi-recipient</p>
                    <div class="mt-4">
                        <div class="text-xs opacity-60" id="address-PaymentSplitter">Not deployed</div>
                        <button onclick="deployContract('PaymentSplitter')" class="mt-2 bg-yellow-600 hover:bg-yellow-700 px-4 py-2 rounded text-sm">
                            Deploy Contract
                        </button>
                    </div>
                </div>
            </div>

            <!-- TRUTH Token (Already Deployed) -->
            <div class="glass rounded-xl p-6" id="contract-TruthToken">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-xl font-semibold">TRUTH Token</h3>
                    <div class="status-indicator status-deployed">‚úÖ</div>
                </div>
                <div class="space-y-2 text-sm">
                    <p><strong>Network:</strong> Base/Zora</p>
                    <p><strong>Type:</strong> ERC-20 Governance</p>
                    <p><strong>Status:</strong> Live on Base</p>
                    <div class="mt-4">
                        <div class="text-xs opacity-60">0x8f6cf6f7747e170f4768533b869c339dc3d30a3c</div>
                        <a href="https://zora.co/coin/base:0x8f6cf6f7747e170f4768533b869c339dc3d30a3c" 
                           target="_blank" class="mt-2 bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded text-sm inline-block">
                            View on Zora
                        </a>
                    </div>
                </div>
            </div>

            <!-- Creator Token (Already Deployed) -->
            <div class="glass rounded-xl p-6" id="contract-CreatorToken">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-xl font-semibold">Creator Token</h3>
                    <div class="status-indicator status-deployed">‚úÖ</div>
                </div>
                <div class="space-y-2 text-sm">
                    <p><strong>Network:</strong> Base/Zora</p>
                    <p><strong>Type:</strong> ERC-20 Creator</p>
                    <p><strong>Status:</strong> Live on Base</p>
                    <div class="mt-4">
                        <div class="text-xs opacity-60">0x22b0434e89882f8e6841d340b28427646c015aa7</div>
                        <a href="https://zora.co/@jacqueantoinedegraff" 
                           target="_blank" class="mt-2 bg-green-600 hover:bg-green-700 px-4 py-2 rounded text-sm inline-block">
                            View Profile
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="glass rounded-xl p-6">
            <h3 class="text-xl font-semibold mb-4">Quick Actions</h3>
            <div class="flex flex-wrap gap-4">
                <button onclick="window.open('/deploy.html', '_blank')" 
                        class="bg-blue-600 hover:bg-blue-700 px-6 py-3 rounded-lg">
                    üöÄ MetaMask Deploy
                </button>
                <button onclick="refreshAllStatus()" 
                        class="bg-purple-600 hover:bg-purple-700 px-6 py-3 rounded-lg">
                    üîÑ Refresh Status
                </button>
                <button onclick="window.open('https://basescan.org', '_blank')" 
                        class="bg-green-600 hover:bg-green-700 px-6 py-3 rounded-lg">
                    üîç View on BaseScan
                </button>
            </div>
        </div>
    </div>

    <script>
        let contractStatuses = {};

        async function initializeDashboard() {
            await waitForDependencies();
            await checkAllContractStatus();
            updateOverview();
        }

        async function waitForDependencies() {
            while (typeof ethers === 'undefined' || typeof TRUTH_CONTRACTS === 'undefined') {
                await new Promise(resolve => setTimeout(resolve, 100));
            }
        }

        async function checkAllContractStatus() {
            const contracts = TRUTH_CONTRACTS.ADDRESSES;
            
            for (const [name, address] of Object.entries(contracts)) {
                await checkContractStatus(name, address);
            }
        }

        async function checkContractStatus(contractName, address) {
            let status = { deployed: false, address: address };

            if (address === '0x...') {
                status = { deployed: false, status: 'Not Deployed', address: 'Not deployed' };
            } else if (contractName === 'TruthToken' || contractName === 'CreatorToken') {
                status = { deployed: true, status: 'Live on Base/Zora', address: address };
            } else {
                try {
                    const provider = new ethers.providers.JsonRpcProvider(TRUTH_CONTRACTS.NETWORK.rpcUrl);
                    const code = await provider.getCode(address);
                    
                    if (code === '0x') {
                        status = { deployed: false, status: 'Invalid Address', address: address };
                    } else {
                        status = { deployed: true, status: 'Deployed', address: address };
                    }
                } catch (error) {
                    status = { deployed: false, status: 'Error Checking', address: address };
                }
            }

            contractStatuses[contractName] = status;
            updateContractDisplay(contractName, status);
        }

        function updateContractDisplay(contractName, status) {
            const statusElement = document.getElementById(`status-${contractName}`);
            const addressElement = document.getElementById(`address-${contractName}`);

            if (statusElement) {
                statusElement.textContent = status.deployed ? '‚úÖ' : '‚ùå';
                statusElement.className = status.deployed ? 'status-indicator status-deployed' : 'status-indicator status-pending';
            }

            if (addressElement) {
                addressElement.textContent = status.deployed ? 
                    `${status.address.slice(0, 6)}...${status.address.slice(-4)}` : 
                    'Not deployed';
            }
        }

        function updateOverview() {
            const deployed = Object.values(contractStatuses).filter(s => s.deployed).length;
            const total = Object.keys(contractStatuses).length;
            const percentage = Math.round((deployed / total) * 100);

            document.getElementById('deployedCount').textContent = deployed;
            document.getElementById('totalContracts').textContent = total;
            document.getElementById('deploymentProgress').textContent = `${percentage}%`;
        }

        async function deployContract(contractName) {
            alert(`Opening MetaMask deployment for ${contractName}...`);
            window.open('/deploy.html', '_blank');
        }

        async function refreshAllStatus() {
            document.getElementById('deployedCount').textContent = '...';
            await checkAllContractStatus();
            updateOverview();
        }

        // Initialize when page loads
        window.addEventListener('load', initializeDashboard);
    </script>
</body>
</html>
